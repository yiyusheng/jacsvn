    用惯了VMWare的虚拟机，再改用微软的Hyper-v虚拟机，自然会走入一个虚拟网卡的设置误区。
 
    用了VMWare，并对它的虚拟网络的设置有一定的了解后，发现它一般有2块虚拟网卡（VMnet1和VMnet8)，每个虚拟网卡都有各自不同的MAC地址和IP地址，并分管一个子网，在子网中充当网关。2块虚拟网卡加上1块物理网卡一共3块，分别对应3种不同的虚拟网络模式：
 
    1.桥接模式，就是直接连到物理网卡上，主观上看上去是把物理网卡按照虚拟机的数量复制了多分，并且每个虚拟器对应不同的MAC地址和IP地址。虚拟机和主机是在同一个子网下的。
 
    2.NAT模式，所有选用NAT模式的虚拟机都在VMnet1对应的子网内，这些虚拟机通过VMnet1可以访问自己所在子网以外网络中的主机
 
    3.Host-only,所有选用该模式的虚拟机都在VMnet8对应的子网内，但这些虚拟机只能访问自己所在子网内的主机
 
    VMWare的虚拟网卡一般启用了除了VMWare Bridge Protocol之外的所有网络协议，而它的物理网卡则启用了包括VMWare Bridge Protocol在内的所有网络协议。
 
    初使用Hyper-v时会发现除了物理网卡外，它一般也会新建一个虚拟网卡，虚拟网卡类似VMWare启用了虚拟网络交换协议之外的所有协议，但它的物理网卡只启用了虚拟网络交换协议。
 
    如果按照VMWare的惯性思维把物理网卡的所有协议都启用（我以前就是这么做的），它也能正常工作。但运行了几个月后问题出现了，机器上的Linux虚拟机都不能识别网卡了，且Windows虚拟机在关机的时候会出现蓝屏现像。出现这些现象时我还没有找到原因，只是将网络全禁用后，再重新配置，各虚拟机又能正常工作了。
 
    但一段时间后又出现了其它问题，先是机器上的VPN服务用户在登陆时不能正常认证了，再就是虚拟网卡无论怎么改它总是有两个IP。在将机器重装后经过仔细分析，发现虚拟网卡居然和物理网卡的MAC地址是一样的，猜想这个虚拟网络交换协议应该和VMWare的桥接协议有本质上的区别，问题应该出在物理网卡的协议设置上题，将物理网卡改会只启用虚拟网络交换协议，发现问题都解决了。
 
    我之所以启用物理网卡的所有协议，是因为在这台电脑上还同时启用了路由服务。我总是认为服务器的路由网络接口应该是物理网卡，如果有些协议不启用，就不能对物理网卡设置IP。经过这一闹我总算对Hyper-v的网络设置有了更深的了解，并且总结出一个小技巧如下：
 
    如果要在Windows server 2008 R2上同时启用Hyper-v和路由角色，一定要先启用Hyper-v角色，再启用路由角色。
