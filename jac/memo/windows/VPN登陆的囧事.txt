    实验室的网速在访问公网时总是显得不尽人意，通过VPN小小的改善下网络状况，但在多人同时使用VPN时出现了一些迨隆
 
    不知道是实验室路由器的BUG，还是被人设置了什么东西，总是同时只能一个人使用VPN登陆，别一个如果要想使用只能在别人断线一段时间后才行，如果是刚断线还不能立即使用。总之具体问题经过考证只能得出一定是实验的路由出了问题。
 
    由于登陆时总是卡在帐号和密码认证那一步，并且出现806错误，错误的大意是网关阻止了GRE协议。Google加百度都无果，没办法只能自己分析原因。由于没有路由器的密码，只能通过截包来分析。发现在仅一人认证成功时使用的GRE协议会话都是正常的，第二个人能走到发送帐号密码那步，说明这步之前的GRE协议会话应该也是正常的，猜想可能是网关防火墙能够识别出GRE协议并能阻止第二个人来使用该协议。
 
    一个自然的想法是对所有的数据包进行加密，让路由器无法识别出这次通信的内容。经过一些尝试，发现VPN客户端的通信模式总是默认选择PPTP,而PPTP并没有对通信数据加密，但如果手动改用L2TP模式，通过截包发现它所有的数据包都是经过加密了的，并且使用的加密算法都是常见的3DES和AES。
 
    这让我小小的兴奋了一下，虽然直接改用L2TP和服务器无法建立通信，但经过尝试发现设置好自定义的IPsec策略密钥，VPN便能认证成功了。现在终于不用惧怕这该死的路由器了。
 
    关于L2TP的设置不同的系统还有点区别，在XP下默认启用了加密算法，但在VISTA下默认并没有启用加密算法，需要修改注册表HKEY_Local_Machine\System\CurrentControl Set\Services\RasMan\Parameters下类型为DWORD叫做ProhibitIpSec的表项的值为0
