#对依赖项目列表过滤
ProjectDependList := $(filter-out $(ProjectExcludeList),$(ProjectDependList))
#项目目录
export ProjectDir := $(shell pwd)
#项目名称
export ProjectName := $(shell basename $(ProjectDir))
#项目临时文件目录
export ProjectTmp := $(SolutionTmp)/$(ProjectName)
#中间目录
export IntDir := $(ProjectTmp)/$(ConfigurationName)
#包含目录
export ProjectInc := $(SolutionInc)/$(ProjectName)
#库目录
export ProjectLib := $(SolutionLib)/$(ConfigurationName)
#bin目录
export ProjectBin := $(SolutionBin)/$(ConfigurationName)

ifeq ($(ConfigurationType),exe)
#输出目录
export OutDir := $(ProjectBin)
#目标名称
export TargetName := $(ProjectName)
#代码生成选项
export LDFLAGS :=
else
ifeq ($(ConfigurationType),dll)
#输出目录
export OutDir := $(ProjectLib)
#目标名称
export TargetName := lib$(ProjectName).so
#代码生成选项
export LDFLAGS := -shared -fPIC
else
#输出目录
export OutDir := $(ProjectLib)
#目标名称
export TargetName := lib$(ProjectName).a
#代码生成选项
export LDFLAGS :=
endif
endif

#需要创建的文件夹
ProjectFolders := $(SolutionBin) $(SolutionLib) $(SolutionTmp) $(ProjectTmp) $(IntDir) $(OutDir)

#预编译头的输出文件
export GCHFile := $(GCHHead).gch
#预编译头的生成目录
export GCHDir := $(ProjectTmp)/GCH/$(ConfigurationName)

#附加包含目录
export AttachInc := -I$(ProjectInc) -I$(SolutionInc) -I$(GCHDir)
#附加库目录
export AttachDllDir := -L$(ProjectLib) -L$(SolutionLib)
#定义宏
export DefMacro :=
ifeq ($(ConfigurationName),debug)
DefMacro := $(DefMacro) -D_DEBUG
else
DefMacro := $(DefMacro) -DNDEBUG
endif
#取消定义宏
export UndoMacro :=
#附加动态库
export AttachDll :=
#附加静态库
export AttachLib :=
#编译选项
export CPPFLAGS := -O3
#静态库生成选项
export ARFLAGS := -r -s

ifdef GCHHead
#预编译头的输出文件的路径
GCH := $(GCHDir)/$(GCHFile)
CPPFLAGS := $(CPPFLAGS) -Winvalid-pch
ProjectFolders := $(ProjectFolders) $(ProjectTmp)/GCH $(GCHDir)
else
GCH :=
endif

#项目所有的源文件
export AllSources := $(shell find $(ProjectDir) \( -name "*.cpp" \))
#项目所有的信赖文件
export AllDepends := $(AllSources:$(ProjectDir)%.cpp=$(IntDir)%.d)
#项目所有的二进制目标文件
export AllObjects := $(AllSources:$(ProjectDir)%.cpp=$(IntDir)%.o)

